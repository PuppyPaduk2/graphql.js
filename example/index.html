<html>
  <head>
    <script src="../graphql.js"></script>
    <script>
      var graph = graphql("https://example.com/graphql", {
        alwaysAutodeclare: true,
        asJSON: true,
        debug: true
      })

      var postId = 123

      var fetchPost = graph.query(`{
        post(id: $id) {
          id
          title
          text
        }
      }`)

      var fetchComments = graph.query(`{
        comments(postId: $postId) {
          comment
          owner {
            name
          }
        }
      }`)

      // This won't send a request.
      fetchPost.merge('buildPage', { id: postId }).then(function (post) {
        console.log(post)
      })

      // This also won't send a request.
      fetchComments.merge('buildPage', { postId: postId }).then(function (comments) {
        console.log(comments)
      })

      // This will send a merged request:
      graph.commit('buildPage').then(function (response) {
        // All base fields will be in response return.
        console.log(response.post)
        console.log(response.comments)
      })
    </script>
  </head>
  <body>

  </body>
</html>