<html>
  <head>
    <script src="../graphql.js"></script>
    <script>
      var graph = graphql("https://xxx.pod-1.api-dev.simprapos.com/admin", {
        alwaysAutodeclare: true,
        asJSON: true,
        debug: true,
        headers: {
          'Auth-Token': 'xxx'
        },
        fragments: {
          tax: "on Tax { id, name }",
          reason: "on Reason { id, name }"
        }
      })

      var allTaxes = graph.query(`
        taxes(with_inactive: true) {
          ... tax
        }
      `)

      var allReasons = graph.query(`
        reasons(with_inactive: true, kind: [returned, cancelled]) {
          ... reason
        }
      `)

      var createTax = graph.mutate(`
        tax_create(input: $input) {
          tax {
            ...tax
          }
        }
      `)

      allTaxes.merge('fetchAll').then(function (response) {
        console.log('Taxes', response)
      })

      allReasons.merge('fetchAll').then(function (response) {
        console.log('Reasons', response)
      })

      createTax.merge('seed', { 'input!TaxCreateInput': { name: { locale: 'en', text:"18"}, rate: 18 } }).then(function (response) {
        console.log('CreateTax 1', response)
      })

      createTax.merge('seed', { 'input!TaxCreateInput': { name: { locale: 'en', text:"8"}, rate: 8 } }).then(function (response) {
        console.log('CreateTax 2', response)
      })

      createTax.merge('seed', { 'input!TaxCreateInput': { name: { locale: 'en', text:"12"}, rate: 12 } }).then(function (response) {
        console.log('CreateTax 3', response)
      })

      graph.commit('fetchAll').then(function (r) {
        console.log(r)
      })
      graph.commit('seed').then(function (r) {
        console.log(r)
      })

      // setTimeout(function () {
      //   graph.commit('fetchAll')
      // }, 1000)

    </script>
  </head>
  <body>

  </body>
</html>